/**
* PreloadJS
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2011 gskinner.com, inc.
* 
* Distributed under the terms of the MIT license.
* http://www.opensource.org/licenses/mit-license.html
*
* This notice shall be included in all copies or substantial portions of the Software.
**/(function(e){var b=function(){this.init()};b.prototype={};var a=b.prototype;a.loaded=false;a.progress=0;a._item=null;a.onProgress=null;a.onLoadStart=null;a.onFileLoad=null;a.onFileProgress=null;a.onComplete=null;a.onError=null;a.getItem=function(){return this._item};a.init=function(){};a.load=function(){};a.cancel=function(){};a._sendLoadStart=function(){if(this.onLoadStart)this.onLoadStart({target:this})};a._sendProgress=function(a){var g;if(a instanceof Number)this.progress=a,g={loaded:this.progress,
total:1};else if(g=a,this.progress=a.loaded/a.total,isNaN(this.progress)||this.progress==Infinity)this.progress=0;g.target=this;if(this.onProgress)this.onProgress(g)};a._sendFileProgress=function(a){if(this.onFileProgress)a.target=this,this.onFileProgress(a)};a._sendComplete=function(){if(this.onComplete)this.onComplete({target:this})};a._sendFileComplete=function(a){if(this.onFileLoad)a.target=this,this.onFileLoad(a)};a._sendError=function(a){if(this.onError)a==null&&(a={}),a.target=this,this.onError(a)};
a.toString=function(){return"[PreloadJS AbstractLoader]"};e.AbstractLoader=b})(window);(function(e){var b=function(a){this.initialize(a)},a=b.prototype=new AbstractLoader;b.IMAGE="image";b.SVG="svg";b.SOUND="sound";b.JSON="json";b.JAVASCRIPT="javascript";b.CSS="css";b.XML="xml";b.TEXT="text";b.TIMEOUT_TIME=8E3;a.useXHR=true;a.stopOnError=false;a.maintainScriptOrder=true;a.next=null;a.typeHandlers=null;a.extensionHandlers=null;a._loadStartWasDispatched=false;a._maxConnections=1;a._currentLoads=null;a._loadQueue=null;a._loadedItemsById=null;a._loadedItemsBySrc=null;a._targetProgress=
0;a._numItems=0;a._numItemsLoaded=null;a._scriptOrder=null;a._loadedScripts=null;a.TAG_LOAD_OGGS=true;a.initialize=function(a){this._targetProgress=this._numItemsLoaded=this._numItems=0;this._paused=false;this._currentLoads=[];this._loadQueue=[];this._scriptOrder=[];this._loadedScripts=[];this._loadedItemsById={};this._loadedItemsBySrc={};this.typeHandlers={};this.extensionHandlers={};this._loadStartWasDispatched=false;this.useXHR=a!=false&&e.XMLHttpRequest!=null;this.determineCapabilities()};a.determineCapabilities=
function(){var a=b.lib.BrowserDetect;if(a!=null)b.TAG_LOAD_OGGS=a.isFirefox||a.isOpera};b.isBinary=function(a){switch(a){case b.IMAGE:case b.SOUND:return true;default:return false}};a.installPlugin=function(a){if(!(a==null||a.getPreloadHandlers==null)){a=a.getPreloadHandlers();if(a.types!=null)for(var d=0,b=a.types.length;d<b;d++)this.typeHandlers[a.types[d]]=a.callback;if(a.extensions!=null)for(d=0,b=a.extensions.length;d<b;d++)this.extensionHandlers[a.extensions[d]]=a.callback}};a.setMaxConnections=
function(a){this._maxConnections=a;this._paused||this._loadNext()};a.loadFile=function(a,d){a==null?this._sendError({text:"File is null."}):(this._addItem(a),d!==false&&this.setPaused(false))};a.loadManifest=function(a,d){var b;if(a instanceof Array){if(a.length==0){this._sendError({text:"Manifest is empty."});return}b=a}else{if(a==null){this._sendError({text:"Manifest is null."});return}b=[a]}for(var c=0,e=b.length;c<e;c++)this._addItem(b[c],false);d!==false&&this._loadNext()};a.load=function(){this.setPaused(false)};
a.getResult=function(a){return this._loadedItemsById[a]||this._loadedItemsBySrc[a]};a.setPaused=function(a){(this._paused=a)||this._loadNext()};a.close=function(){for(;this._currentLoads.length;)this._currentLoads.pop().cancel();this._currentLoads=[];this._scriptOrder=[];this._loadedScripts=[]};a._addItem=function(a){a=this._createLoadItem(a);a!=null&&(this._loadQueue.push(a),this._numItems++,this._updateProgress(),a.getItem().type==b.JAVASCRIPT&&(this._scriptOrder.push(a.getItem()),this._loadedScripts.push(null)))};
a._loadNext=function(){if(!this._paused){if(!this._loadStartWasDispatched)this._sendLoadStart(),this._loadStartWasDispatched=true;if(this._numItems==this._numItemsLoaded)this.loaded=true,this._sendComplete(),this.next&&this.next.load&&this.next.load.apply(this.next);for(;this._loadQueue.length&&this._currentLoads.length<this._maxConnections;)this._loadItem(this._loadQueue.shift())}};a._loadItem=function(a){a.onProgress=b.proxy(this._handleProgress,this);a.onComplete=b.proxy(this._handleFileComplete,
this);a.onError=b.proxy(this._handleFileError,this);this._currentLoads.push(a);a.load()};a._handleFileError=function(a){var a=a.target,d=this._createResultData(a.getItem());this._numItemsLoaded++;this._updateProgress();this._sendError(d);this.stopOnError||(this._removeLoadItem(a),this._loadNext())};a._createResultData=function(a){var d={id:a.id,result:null,data:a.data,type:a.type,src:a.src};this._loadedItemsById[a.id]=d;return this._loadedItemsBySrc[a.src]=d};a._handleFileComplete=function(a){var a=
a.target,d=a.getItem(),c=this._createResultData(d);this._removeLoadItem(a);c.result=a instanceof b.lib.XHRLoader?this._createResult(d,a.getResult()):d.tag;switch(d.type){case b.IMAGE:if(a instanceof b.lib.XHRLoader){var f=this;c.result.onload=function(){f._handleFileTagComplete(d,c)};return}break;case b.JAVASCRIPT:if(this.maintainScriptOrder){this._loadedScripts[this._scriptOrder.indexOf(d)]=d;this._checkScriptLoadOrder(a);return}}this._handleFileTagComplete(d,c)};a._checkScriptLoadOrder=function(){for(var a=
this._loadedScripts.length,d=0;d<a;d++){var b=this._loadedScripts[d];if(b===null)break;if(b!==true){var c=this.getResult(b.src),b=this.getResult(b.id);b.result=c.result;this._handleFileTagComplete(c,b);this._loadedScripts[d]=true;d--;a--}}};a._handleFileTagComplete=function(a,b){this._numItemsLoaded++;a.completeHandler&&a.completeHandler(b);this._updateProgress();this._sendFileComplete(b);this._loadNext()};a._removeLoadItem=function(a){for(var b=this._currentLoads.length,c=0;c<b;c++)if(this._currentLoads[c]==
a){this._currentLoads.splice(c,1);break}};a._createResult=function(a,d){var c=null,f;switch(a.type){case b.IMAGE:c=this._createImage();break;case b.SOUND:c=a.tag||this._createAudio();break;case b.CSS:c=this._createLink();break;case b.JAVASCRIPT:c=this._createScript();break;case b.SVG:var c=this._createSVG(),e=this._createXML(d,"image/svg+xml");c.appendChild(e);break;case b.XML:f=this._createXML(d,"text/xml");break;case b.JSON:case b.TEXT:f=d}if(c){if(a.type==b.CSS)c.href=a.src;else if(a.type!=b.SVG)c.src=
a.src;return c}else return f};a._createXML=function(a,b){var c;e.DOMParser?(c=new DOMParser,c=c.parseFromString(a,b)):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async=false,c.loadXML(a));return c};a._handleProgress=function(a){var a=a.target,b=this._createResultData(a.getItem());b.progress=a.progress;this._sendFileProgress(b);this._updateProgress()};a._updateProgress=function(){var a=this._numItemsLoaded/this._numItems,b=this._numItems-this._numItemsLoaded;if(b>0){for(var c=0,e=0,h=this._currentLoads.length;e<
h;e++)c+=this._currentLoads[e].progress;a+=c/b*(b/this._numItems)}this._sendProgress({loaded:a,total:1})};a._createLoadItem=function(a){var c={};switch(typeof a){case "string":c.src=a;break;case "object":a instanceof HTMLAudioElement?(c.tag=a,c.src=c.tag.src,c.type=b.SOUND):c=a}c.ext=this._getNameAfter(c.src,".");if(!c.type)c.type=this.getType(c.ext);if(c.id==null||c.id=="")c.id=c.src;if(a=this.typeHandlers[c.type]||this.extensionHandlers[c.ext]){a=a(c.src,c.type,c.id,c.data);if(a===false)return null;
else if(a!==true){if(a.src!=null)c.src=a.src;if(a.id!=null)c.id=a.id;if(a.tag!=null&&a.tag.load instanceof Function)c.tag=a.tag}c.ext=this._getNameAfter(c.src,".")}a=this.useXHR;switch(c.type){case b.JSON:case b.XML:case b.TEXT:a=true;break;case b.SOUND:c.ext=="ogg"&&b.TAG_LOAD_OGGS&&(a=false)}return this.useXHR==true&&(c.type==b.IMAGE||c.type==b.SVG)?(c=this._createTagItem(c),c.useXHR=true,c):a?new b.lib.XHRLoader(c):c.tag?new b.lib.TagLoader(c):this._createTagItem(c)};a._createTagItem=function(a){var c,
e="src",f=false;switch(a.type){case b.IMAGE:c=this._createImage();break;case b.SOUND:c=this._createAudio();break;case b.CSS:e="href";f=true;c=this._createLink();break;case b.JAVASCRIPT:f=true;c=this._createScript();break;case b.SVG:e="data",c=this._createSVG()}a.tag=c;return new b.lib.TagLoader(a,e,f)};a.getType=function(a){switch(a){case "jpeg":case "jpg":case "gif":case "png":return b.IMAGE;case "ogg":case "mp3":case "wav":return b.SOUND;case "json":return b.JSON;case "xml":return b.XML;case "css":return b.CSS;
case "js":return b.JAVASCRIPT;case "svg":return b.SVG;default:return b.TEXT}};a._getNameAfter=function(a,c){var b=a.lastIndexOf(c),b=a.substr(b+1),e=b.lastIndexOf(/[\b|\?|\#|\s]/);return e==-1?b:b.substr(0,e)};a._createImage=function(){return document.createElement("img")};a._createSVG=function(){var a=document.createElement("object");a.type="image/svg+xml";return a};a._createAudio=function(){var a=document.createElement("audio");a.autoplay=false;a.type="audio/ogg";return a};a._createScript=function(){var a=
document.createElement("script");a.type="text/javascript";return a};a._createLink=function(){var a=document.createElement("link");a.type="text/css";a.rel="stylesheet";return a};a.toString=function(){return"[PreloadJS]"};b.proxy=function(a,c){return function(b){return a.apply(c,arguments)}};b.lib={};e.PreloadJS=b;var c=function(){};c.init=function(){var a=navigator.userAgent;c.isFirefox=a.indexOf("Firefox")>-1;c.isOpera=e.opera!=null;c.isIOS=a.indexOf("iPod")>-1||a.indexOf("iPhone")>-1||a.indexOf("iPad")>
-1};c.init();b.lib.BrowserDetect=c})(window);(function(){var e=function(a,c,b){this.init(a,c,b)},b=e.prototype=new AbstractLoader;b._srcAttr=null;b._loadTimeOutTimeout=null;b.tagCompleteProxy=null;b.init=function(a,c,b){this._item=a;this._srcAttr=c||"src";this.useXHR=b==true;this.isAudio=a.tag instanceof HTMLAudioElement;this.tagCompleteProxy=PreloadJS.proxy(this._handleTagLoad,this)};b.cancel=function(){this._clean();var a=this.getItem();if(a!=null)a.src=null};b.load=function(){this.useXHR?this.loadXHR():this.loadTag()};b.loadXHR=function(){var a=
this.getItem(),a=new PreloadJS.lib.XHRLoader(a);a.onProgress=PreloadJS.proxy(this._handleProgress,this);a.onFileLoad=PreloadJS.proxy(this._handleXHRComplete,this);a.onComplete=PreloadJS.proxy(this._handleXHRComplete,this);a.onError=PreloadJS.proxy(this._handleLoadError,this);a.load()};b._handleXHRComplete=function(a){this._clean();a.target.onFileLoad=null;a.target.onComplete=null;var c=a.target.getItem();a.target.getResult();c.type==PreloadJS.IMAGE?(c.tag.onload=PreloadJS.proxy(this._sendComplete,
this),c.tag.src=c.src):(c.tag[this._srcAttr]=c.src,this._sendComplete())};b._handleLoadError=function(a){a.error&&a.error.code==101?this.loadTag():(this._clean(),this._sendError(a))};b.loadTag=function(){var a=this.getItem(),c=a.tag;clearTimeout(this._loadTimeOutTimeout);this._loadTimeOutTimeout=setTimeout(PreloadJS.proxy(this._handleLoadTimeOut,this),PreloadJS.TIMEOUT_TIME);if(this.isAudio)c.src=null,c.preload="auto",c.setAttribute("data-temp","true");c.onerror=PreloadJS.proxy(this._handleLoadError,
this);c.onprogress=PreloadJS.proxy(this._handleProgress,this);this.isAudio?(c.onstalled=PreloadJS.proxy(this._handleStalled,this),c.addEventListener("canplaythrough",this.tagCompleteProxy,false)):c.onload=PreloadJS.proxy(this._handleTagLoad,this);c[this._srcAttr]=a.src;a.type==PreloadJS.SVG&&document.getElementsByTagName("body")[0].appendChild(c);a=a.type==PreloadJS.SOUND&&a.ext=="ogg"&&PreloadJS.lib.BrowserDetect.isFirefox;c.load!=null&&!a&&c.load()};b._handleLoadTimeOut=function(){this._clean();
this._sendError()};b._handleStalled=function(){};b._handleLoadError=function(){this._clean();this._sendError()};b._handleTagLoad=function(){var a=this.getItem().tag;clearTimeout(this._loadTimeOutTimeout);if(!(this.loaded||this.isAudio&&a.readyState!==4))this.getItem().type==PreloadJS.SVG&&document.getElementsByTagName("body")[0].removeChild(a),this.loaded=true,this._clean(),this._sendComplete()};b._clean=function(){clearTimeout(this._loadTimeOutTimeout);var a=this.getItem().tag;a.onload=null;a.removeEventListener("canplaythrough",
this.tagCompleteProxy,false);a.onstalled=null;a.onprogress=null;a.onerror=null};b._handleProgress=function(a){clearTimeout(this._loadTimeOutTimeout);if(this.isAudio){a=this.getItem();if(a.buffered==null)return;a={loaded:a.buffered.length>0?a.buffered.end(0):0,total:a.duration}}this._sendProgress(a)};b.toString=function(){return"[PreloadJS TagLoader]"};PreloadJS.lib.TagLoader=e})(window);(function(e){var b=function(a){this.init(a)},a=b.prototype=new AbstractLoader;a._wasLoaded=false;a._request=null;a._loadTimeOutTimeout=null;a._xhrLevel=null;a.init=function(a){this._item=a;this._createXHR(a)};a.getResult=function(){try{return this._request.responseText}catch(a){}return this._request.response};a.cancel=function(){this._clean();this._request.abort()};a.load=function(){if(this._request==null)this.handleError();else{if(this._xhrLevel==1)this._loadTimeOutTimeout=setTimeout(PreloadJS.proxy(this.handleTimeout,
this),PreloadJS.TIMEOUT_TIME);this._request.onloadstart=PreloadJS.proxy(this.handleLoadStart,this);this._request.onprogress=PreloadJS.proxy(this.handleProgress,this);this._request.onabort=PreloadJS.proxy(this.handleAbort,this);this._request.onerror=PreloadJS.proxy(this.handleError,this);this._request.ontimeout=PreloadJS.proxy(this.handleTimeout,this);this._request.onload=PreloadJS.proxy(this.handleLoad,this);this._request.onreadystatechange=PreloadJS.proxy(this.handleReadyStateChange,this);try{this._request.send()}catch(a){this._sendError({source:a})}}};
a.handleProgress=function(a){a.loaded>0&&a.total==0||this._sendProgress({loaded:a.loaded,total:a.total})};a.handleLoadStart=function(){clearTimeout(this._loadTimeOutTimeout);this._sendLoadStart()};a.handleAbort=function(){this._clean();this._sendError()};a.handleError=function(){this._clean();this._sendError()};a.handleReadyStateChange=function(){this._request.readyState==4&&this.handleLoad()};a._checkError=function(){switch(parseInt(this._request.status)){case 404:case 0:return false}return this._hasResponse()||
this._hasTextResponse()||this._hasXMLResponse()};a._hasResponse=function(){return this._request.response!=null};a._hasTextResponse=function(){try{return this._request.responseText!=null}catch(a){return false}};a._hasXMLResponse=function(){try{return this._request.responseXML!=null}catch(a){return false}};a.handleLoad=function(){if(!this.loaded)this.loaded=true,this._checkError()?(this._clean(),this._sendComplete()):this.handleError()};a.handleTimeout=function(){this._clean();this._sendError()};a._createXHR=
function(a){this._xhrLevel=1;if(e.ArrayBuffer)this._xhrLevel=2;if(e.XMLHttpRequest)this._request=new XMLHttpRequest;else try{this._request=new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(b){return null}a.type==PreloadJS.TEXT&&this._request.overrideMimeType&&this._request.overrideMimeType("text/plain; charset=x-user-defined");this._request.open("GET",a.src,true);if(PreloadJS.isBinary(a.type))this._request.responseType="arraybuffer";return true};a._clean=function(){clearTimeout(this._loadTimeOutTimeout);
var a=this._request;a.onloadstart=null;a.onprogress=null;a.onabort=null;a.onerror=null;a.onload=null;a.ontimeout=null;a.onloadend=null;a.onreadystatechange=null;clearInterval(this._checkLoadInterval)};a.toString=function(){return"[PreloadJS XHRLoader]"};PreloadJS.lib.XHRLoader=b})(window);
